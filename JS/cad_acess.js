/* JS DB Connection Hidden */
(function(_0x30f683,_0x57b8cc){function _0x2157ca(_0x2bb748,_0x7d713d,_0x3630ee,_0x25ec3e){return _0x27ae(_0x7d713d-0x202,_0x25ec3e);}function _0x1e73a8(_0x303f47,_0x18c3a5,_0x2ba4fe,_0x3542f5){return _0x27ae(_0x3542f5-0x8f,_0x303f47);}const _0x4ef9a2=_0x30f683();while(!![]){try{const _0x7c623c=-parseInt(_0x1e73a8(0x179,0x1a6,0x188,0x18e))/(0x402+-0x1af3+-0x6*-0x3d3)*(-parseInt(_0x1e73a8(0x172,0x181,0x186,0x18c))/(-0x1d7b+-0x12f*-0x1b+-0x4f*0x8))+parseInt(_0x1e73a8(0x18b,0x177,0x16f,0x17b))/(0x1634+0xcd+-0x16fe)*(-parseInt(_0x1e73a8(0x199,0x170,0x194,0x17d))/(-0x4*-0x383+0x2669+-0x3471))+-parseInt(_0x2157ca(0x30a,0x2f5,0x2fc,0x2f4))/(-0x4aa*-0x4+-0x2*-0x1264+-0x376b)*(-parseInt(_0x1e73a8(0x17a,0x155,0x183,0x16c))/(0xd*-0x187+-0x1*-0x313+0x10ce))+parseInt(_0x2157ca(0x2d1,0x2de,0x2e4,0x2ce))/(-0xf07+0x1c9f*0x1+-0xd91*0x1)+-parseInt(_0x1e73a8(0x158,0x163,0x167,0x170))/(0x46*-0x2b+0x2312+-0x1748)+-parseInt(_0x2157ca(0x2e4,0x2f8,0x2f6,0x2e7))/(-0x2*0xf05+-0x48+0x1e5b)*(-parseInt(_0x2157ca(0x2b2,0x2cc,0x2c8,0x2df))/(0xb82+-0x5*-0x49a+-0x227a))+parseInt(_0x2157ca(0x2ee,0x2d1,0x2ee,0x2cb))/(0xc5e+-0x3*0xc45+0x2*0xc3e);if(_0x7c623c===_0x57b8cc)break;else _0x4ef9a2['push'](_0x4ef9a2['shift']());}catch(_0x553930){_0x4ef9a2['push'](_0x4ef9a2['shift']());}}}(_0x340a,-0x2*0x47edf+0x8e503+-0x113e*-0xb9));function _0x51c211(_0x10982b,_0x52dc13,_0x2b7c65,_0x4bf475){return _0x27ae(_0x2b7c65-0x22d,_0x52dc13);}const _0x395673=(function(){let _0x38af2a=!![];return function(_0x1cff14,_0x450356){const _0x431000=_0x38af2a?function(){function _0x573a05(_0x57e9e4,_0x26daa8,_0x3ad99a,_0x2748b9){return _0x27ae(_0x3ad99a-0x1,_0x57e9e4);}if(_0x450356){const _0x1c4d6a=_0x450356[_0x573a05(0xba,0xc5,0xd6,0xbe)](_0x1cff14,arguments);return _0x450356=null,_0x1c4d6a;}}:function(){};return _0x38af2a=![],_0x431000;};}()),_0x17ddac=_0x395673(this,function(){function _0x4bdeea(_0x2c2f47,_0x124a3b,_0x219698,_0x6dd60a){return _0x27ae(_0x6dd60a- -0x195,_0x2c2f47);}const _0x284357={};_0x284357[_0x4bdeea(-0xc4,-0xbc,-0xc5,-0xce)]=_0x4bdeea(-0x9b,-0xa6,-0xc3,-0xa5)+'+$';const _0x57a7fa=_0x284357;function _0x917cb3(_0x2e4182,_0x1748e2,_0x129d5a,_0x448d0f){return _0x27ae(_0x448d0f-0x234,_0x129d5a);}return _0x17ddac[_0x4bdeea(-0xa5,-0xba,-0xac,-0xaf)]()[_0x917cb3(0x338,0x33c,0x33f,0x325)](_0x57a7fa[_0x4bdeea(-0xd3,-0xb2,-0xba,-0xce)])[_0x917cb3(0x332,0x304,0x300,0x31a)]()['constructo'+'r'](_0x17ddac)[_0x917cb3(0x30b,0x332,0x33d,0x325)](_0x4bdeea(-0xb5,-0x8d,-0x92,-0xa5)+'+$');});function _0x5d646f(_0x24de1a,_0x529245,_0x569eb3,_0x3d7232){return _0x27ae(_0x569eb3-0x320,_0x529245);}function _0x340a(){const _0x3ec247=['y29UC29Szq','otGWmtrmr2H2Dg4','wfPmsLLvAviZEa','ChjVDg90ExbL','t0XhBue0utDsDW','r0j2tvG','tvDNB3K','CLn5wNq','sKvnt2e','ndG3otaWsg9rsgrI','ChHJEwHRDhyUCW','EgDcvw8','CfHwq0O5lMv5sG','BuzTwM5cm2fUuG','mZG4ntqYmeTrD0zYCa','DxLczfq','DhjHy2u','DxbHyMfZzs5JBW','BgvUz3rO','E30Uy29UC3rYDq','yxbWBhK','B0XOzxK','BMjyBgLAwei0wq','AwnToxnAu0K2sq','wejOww1gELPtsq','m2P0m01Vvue','CgmZtwLpAuP6za','mZy4ntC4uNbMAMLp','nZmYmZi0A1jLzuzN','BMn0Aw9UkcKG','Bg9N','zxHJzxb0Aw9U','nJyYotG1nMDKCuPRsq','zxjYB3i','Buz1yJi0AuXdsG','DgfIBgu','AMT5tvrbEu56vq','Dg9tDhjPBMC','C0LTvJrJq0K2tq','yMLUza','zNb3ANrNBxLIzq','rfnVBey','BNPiz0q','m3Dzsurkvq','A2rTDxvRAu9cua','mZC4mdi0nenUwhPluG','AKeWtKrJne5Qsq','kcGOlISPkYKRkq','C2vHCMnO','CM4GDgHPCYiPka','nw1JrejPCq','CfLyuwLpAKuZtq','uwPqv2C','otbYs1LqAu8','y3rVCIGICMv0Dq','qKL4wKW','q2rvBLq','m05ymc5ludflqG','Aw5MBW','Ahr0Chm6lY9HzG','mZjKrvrSDvO'];_0x340a=function(){return _0x3ec247;};return _0x340a();}_0x17ddac();const _0x528257=(function(){const _0x153faa={};_0x153faa[_0x13f071(0x1f5,0x1ec,0x203,0x1f1)]=function(_0x31effb,_0x3aee85){return _0x31effb===_0x3aee85;},_0x153faa[_0xfe75ee(0x197,0x17a,0x187,0x180)]='GBvMX';const _0x59637e=_0x153faa;function _0x13f071(_0x5bcfd3,_0x2c332e,_0x4821ba,_0x47f7e1){return _0x27ae(_0x5bcfd3-0x125,_0x4821ba);}function _0xfe75ee(_0x44ef2d,_0x2a5536,_0x3822aa,_0x69141f){return _0x27ae(_0x2a5536-0xb2,_0x3822aa);}let _0x1e4108=!![];return function(_0x2642bd,_0x225723){const _0x45b516={'JEMOa':function(_0x29d52e,_0x2aa0d3){function _0x2e45a6(_0x4a7fd7,_0x5c0745,_0x2b68af,_0x471597){return _0x27ae(_0x2b68af-0x1af,_0x4a7fd7);}return _0x59637e[_0x2e45a6(0x27c,0x268,0x27f,0x291)](_0x29d52e,_0x2aa0d3);},'nzHgD':_0x59637e['rSyZt']},_0x300fcf=_0x1e4108?function(){function _0x37a16b(_0x5dcd64,_0x1b6dd7,_0x4fe6dd,_0x196a75){return _0x27ae(_0x4fe6dd-0x7c,_0x1b6dd7);}function _0x3a7339(_0x38407a,_0x3400bd,_0x16d881,_0x5b228d){return _0x27ae(_0x5b228d- -0x2f9,_0x16d881);}if(_0x45b516[_0x3a7339(-0x24c,-0x215,-0x236,-0x230)](_0x3a7339(-0x243,-0x245,-0x22d,-0x233),_0x45b516[_0x37a16b(0x16b,0x15c,0x167,0x16e)])){if(_0x225723){const _0x2ed015=_0x225723['apply'](_0x2642bd,arguments);return _0x225723=null,_0x2ed015;}}else{const _0x38a661=_0x52045b?function(){function _0x5c363f(_0x48ad10,_0x3c4e6e,_0x4ec75f,_0x3900be){return _0x3a7339(_0x48ad10-0x13b,_0x3c4e6e-0x1bc,_0x48ad10,_0x3900be-0x615);}if(_0x3fab29){const _0x105239=_0x4a4ec3[_0x5c363f(0x3eb,0x3ef,0x3d7,0x3f1)](_0x2f3a99,arguments);return _0x14fb76=null,_0x105239;}}:function(){};return _0x37b178=![],_0x38a661;}}:function(){};return _0x1e4108=![],_0x300fcf;};}()),_0x94ea9c=_0x528257(this,function(){const _0x3ba683={'Xwhlb':function(_0x157962,_0x3eef7d){return _0x157962(_0x3eef7d);},'CvPGk':function(_0x15f098,_0x248886){return _0x15f098+_0x248886;},'rbDyS':'return\x20(fu'+_0x224800(0x4c6,0x4b6,0x4c2,0x4c6),'BIxZL':function(_0x4b76fd){return _0x4b76fd();},'DSolF':_0x224800(0x4cc,0x4b7,0x4b1,0x4c7),'CdUnT':'warn','QjPWg':_0x27ad9c(-0x264,-0x243,-0x249,-0x23c),'xgBUo':_0x27ad9c(-0x243,-0x242,-0x24b,-0x23d),'oasBC':_0x27ad9c(-0x260,-0x263,-0x247,-0x258),'qFtuZ':_0x224800(0x4a8,0x4bc,0x4c6,0x4b9),'oLhey':function(_0x3706fa,_0x2c32e1){return _0x3706fa<_0x2c32e1;}};let _0x166d5;try{const _0x3d8066=_0x3ba683['Xwhlb'](Function,_0x3ba683['CvPGk'](_0x3ba683['rbDyS']+(_0x27ad9c(-0x243,-0x25b,-0x257,-0x253)+_0x27ad9c(-0x250,-0x221,-0x234,-0x241)+_0x27ad9c(-0x23a,-0x232,-0x239,-0x227)+'\x20)'),');'));_0x166d5=_0x3ba683[_0x27ad9c(-0x23e,-0x221,-0x233,-0x229)](_0x3d8066);}catch(_0x5c2df9){_0x166d5=window;}function _0x224800(_0x178a36,_0x18fb2c,_0x56c3dd,_0x4926f4){return _0x27ae(_0x4926f4-0x3e8,_0x18fb2c);}function _0x27ad9c(_0x287ae0,_0x675761,_0xc008a8,_0xd01a7e){return _0x27ae(_0xc008a8- -0x32b,_0x287ae0);}const _0x4ae696=_0x166d5[_0x27ad9c(-0x238,-0x233,-0x22d,-0x21b)]=_0x166d5[_0x27ad9c(-0x233,-0x213,-0x22d,-0x248)]||{},_0x19bd43=[_0x3ba683[_0x224800(0x4d3,0x4de,0x4d0,0x4d2)],_0x3ba683[_0x224800(0x4fe,0x4c9,0x4cf,0x4e1)],_0x27ad9c(-0x215,-0x23d,-0x230,-0x219),_0x3ba683[_0x224800(0x4f3,0x4de,0x4f3,0x4dd)],_0x3ba683[_0x27ad9c(-0x24a,-0x254,-0x25f,-0x270)],_0x3ba683['oasBC'],_0x3ba683['qFtuZ']];for(let _0x3de2e5=-0x1ea0+-0x7ed+-0x47*-0x8b;_0x3ba683[_0x27ad9c(-0x236,-0x26b,-0x255,-0x24f)](_0x3de2e5,_0x19bd43[_0x27ad9c(-0x243,-0x258,-0x258,-0x241)]);_0x3de2e5++){const _0xc6fab0=_0x528257['constructo'+'r'][_0x224800(0x4a5,0x4bd,0x499,0x4ac)][_0x224800(0x4d1,0x4c9,0x4d5,0x4d0)](_0x528257),_0x1ba12f=_0x19bd43[_0x3de2e5],_0x22a903=_0x4ae696[_0x1ba12f]||_0xc6fab0;_0xc6fab0['__proto__']=_0x528257[_0x27ad9c(-0x225,-0x230,-0x243,-0x24e)](_0x528257),_0xc6fab0['toString']=_0x22a903[_0x27ad9c(-0x230,-0x239,-0x245,-0x23b)][_0x27ad9c(-0x246,-0x247,-0x243,-0x231)](_0x22a903),_0x4ae696[_0x1ba12f]=_0xc6fab0;}});_0x94ea9c();import{createClient}from'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';function _0x27ae(_0x17378f,_0x20aff6){const _0x35fb94=_0x340a();return _0x27ae=function(_0x12152c,_0x10eb9d){_0x12152c=_0x12152c-(-0x2bf*-0x7+-0x211*0x1+-0x1065);let _0x48fcae=_0x35fb94[_0x12152c];if(_0x27ae['RXbdPY']===undefined){var _0x4cd020=function(_0x26cb8e){const _0x2c5c45='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x646d71='',_0x3b5fe4='',_0xd33247=_0x646d71+_0x4cd020;for(let _0x22b238=-0x1*0x1385+0xb8*0xb+0xb9d,_0x499dc0,_0x42d79d,_0x3b65ad=-0x1e2*-0x1+0x2*-0xeda+0x946*0x3;_0x42d79d=_0x26cb8e['charAt'](_0x3b65ad++);~_0x42d79d&&(_0x499dc0=_0x22b238%(0x1*-0x933+0x175*-0x10+0x2087)?_0x499dc0*(-0x7*0x188+-0x2*-0xd69+-0xfda)+_0x42d79d:_0x42d79d,_0x22b238++%(0x26e3+0x2*0xf38+-0x454f))?_0x646d71+=_0xd33247['charCodeAt'](_0x3b65ad+(0x13f+-0x38a+0x255))-(-0xf1*-0xd+0xb8f+-0x1*0x17c2)!==0x13b6+0x647+-0x19fd?String['fromCharCode'](0x7d*-0x1e+0x2238+-0x1293&_0x499dc0>>(-(-0x1943*0x1+0x1805+0x20*0xa)*_0x22b238&0x68f+-0x4*-0x346+-0x1*0x13a1)):_0x22b238:-0xaf1*0x2+-0xe*0xee+0x1173*0x2){_0x42d79d=_0x2c5c45['indexOf'](_0x42d79d);}for(let _0x319f28=0xbc6+-0xd7c+0x1b6,_0x27dd38=_0x646d71['length'];_0x319f28<_0x27dd38;_0x319f28++){_0x3b5fe4+='%'+('00'+_0x646d71['charCodeAt'](_0x319f28)['toString'](-0x234e*-0x1+0xd9*0x20+0x3e5e*-0x1))['slice'](-(0x17*0x167+-0x458+0x1*-0x1be7));}return decodeURIComponent(_0x3b5fe4);};_0x27ae['IpfQZh']=_0x4cd020,_0x17378f=arguments,_0x27ae['RXbdPY']=!![];}const _0x27c44d=_0x35fb94[0x2c6+0x1ebe+-0x2184],_0x4a0bf9=_0x12152c+_0x27c44d,_0x235a96=_0x17378f[_0x4a0bf9];if(!_0x235a96){const _0x45f935=function(_0x5ab6bf){this['wNCVGG']=_0x5ab6bf,this['MQaRYx']=[0x1c98+-0x1fea+-0x17*-0x25,-0x1dbc+-0x79d+0x2559,-0x1cff+-0x3d*0x6b+0x367e],this['oRCcMp']=function(){return'newState';},this['NHWmzX']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['UiWSsJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x45f935['prototype']['HTFWRL']=function(){const _0x2527b8=new RegExp(this['NHWmzX']+this['UiWSsJ']),_0x55f7d5=_0x2527b8['test'](this['oRCcMp']['toString']())?--this['MQaRYx'][-0x66a+0x1d86+-0x7*0x34d]:--this['MQaRYx'][-0x1bd1+0x1bb4+0x1d];return this['dvOvBL'](_0x55f7d5);},_0x45f935['prototype']['dvOvBL']=function(_0x4053d5){if(!Boolean(~_0x4053d5))return _0x4053d5;return this['ZWYjzD'](this['wNCVGG']);},_0x45f935['prototype']['ZWYjzD']=function(_0x4f9c8b){for(let _0x5de294=0x6*0x135+-0xe88+-0x6*-0x137,_0x5e9880=this['MQaRYx']['length'];_0x5de294<_0x5e9880;_0x5de294++){this['MQaRYx']['push'](Math['round'](Math['random']())),_0x5e9880=this['MQaRYx']['length'];}return _0x4f9c8b(this['MQaRYx'][-0x1*0xeed+-0x2*0x482+0x17f1]);},new _0x45f935(_0x27ae)['HTFWRL'](),_0x48fcae=_0x27ae['IpfQZh'](_0x48fcae),_0x17378f[_0x4a0bf9]=_0x48fcae;}else _0x48fcae=_0x235a96;return _0x48fcae;},_0x27ae(_0x17378f,_0x20aff6);}const supabase=createClient(_0x5d646f(0x424,0x40f,0x41c,0x433)+_0x51c211(0x325,0x319,0x316,0x318)+_0x5d646f(0x3d4,0x3e8,0x3eb,0x3f4)+_0x51c211(0x2ed,0x2fe,0x2ff,0x31a),'eyJhbGciOi'+'JIUzI1NiIs'+'InR5cCI6Ik'+_0x5d646f(0x3fd,0x3e5,0x3ed,0x3f4)+_0x51c211(0x301,0x314,0x308,0x325)+_0x5d646f(0x3fc,0x3dc,0x3f9,0x412)+'sInJlZiI6I'+_0x5d646f(0x3d7,0x3fa,0x3ee,0x3e8)+_0x51c211(0x305,0x311,0x304,0x2f3)+'3loa3R2Iiw'+_0x5d646f(0x3f3,0x404,0x3f8,0x3fc)+_0x51c211(0x310,0x30b,0x310,0x31e)+_0x5d646f(0x3fe,0x418,0x414,0x409)+_0x5d646f(0x3f1,0x416,0x405,0x421)+_0x5d646f(0x415,0x41d,0x407,0x3f0)+_0x5d646f(0x41d,0x413,0x40f,0x40f)+_0x5d646f(0x406,0x411,0x41a,0x42e)+_0x5d646f(0x3f5,0x40a,0x40d,0x41f)+_0x51c211(0x2f5,0x2e9,0x2f2,0x2e0)+_0x51c211(0x2fb,0x2ec,0x2f0,0x2fb)+_0x51c211(0x2e8,0x307,0x307,0x304));
/* JS DB Connection Hidden */

const { data, error } = await supabase
.from('TGFUSU')
.select(`username`)


// Function to create an Excel-like table
function createExcelTable(data) {
    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const tbody = document.createElement('tbody');

    // Create header row
    const headerRow = document.createElement('tr');
    const headers = Object.keys(data[0]);
    headers.forEach(header => {
    const th = document.createElement('th');
    th.textContent = header.charAt(0).toUpperCase() + header.slice(1);
    headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);

    // Create data rows
    data.forEach(row => {
    const tr = document.createElement('tr');
    headers.forEach(key => {
        const td = document.createElement('td');
        td.textContent = row[key];
        tr.appendChild(td);
    });
    tbody.appendChild(tr);
    });

    table.appendChild(thead);
    table.appendChild(tbody);
    document.getElementById('excelTable').appendChild(table);
}

async function updateUser(acao) {
    // Retrieve input values
    var userCreate = document.getElementById("CreateUserGeren").value;
    var emailCreate = document.getElementById("CreateEmailGeren").value;
    var passwordCreate = document.getElementById("CreatePasswordGeren").value;

    // Initial values for access rights
    var acessRel = document.getElementById('acessRel').checked;
    var admin = document.getElementById('admin').checked;
    var rastreio = document.getElementById('acessRas').checked;
    var cadastro = document.getElementById('acessCad').checked;

    // Create JSON dynamically
    const jsonf = {};

    if (emailCreate) {
        jsonf.email = emailCreate;
    }
    if (passwordCreate) {
        jsonf.password = passwordCreate;
    }
    if (acessRel) {
        if (acao == 'add') {
            jsonf.acess_charts = acessRel;
        } else if (acao == 'del') {
            jsonf.acess_charts = false;
        }
    }
    if (cadastro) {
        if (acao == 'add') {
            jsonf.acess_cadastro = cadastro;
        } else if (acao == 'del') {
            jsonf.acess_cadastro = false;
        }
    }
    if (admin) {
        if (acao == 'add') {
            jsonf.admin = admin;
        } else if (acao == 'del') {
            jsonf.admin = false;
        }
    }
    if (rastreio) {
        if (acao == 'add') {
            jsonf.acess_rastreio = rastreio;
        } else if (acao == 'del') {
            jsonf.acess_rastreio = false;
        }
    }

    console.log(jsonf);

    var count = 0

    if (userCreate == 'admin') {
        userCreate = ''
    }
    
    const { count: userCount, error: userError } = await supabase
        .from('TGFUSU')
        .select('*', { count: 'exact', head: true })
        .eq('username', userCreate)

    count = userCount

    if (count == 1) {
        if (acao == 'add' || acao == 'del') {
            const { data, error } = await supabase
                .from('TGFUSU')
                .update(jsonf)
                .eq('username', userCreate) 
                .select(); 
            
            if (error) {
                console.error('Error updating user:', error);
            } else {
                window.alert('User updated!')
            }
        } else if (acao == 'exc') {
            const response = await supabase
                .from('TGFUSU')
                .delete()
                .eq('username', userCreate)
            window.alert('Usuário Apagado!')
        }        
    } else {
        window.alert('Usuário não existe ou não pode ser alteado')
    }

    if (error) {
        console.error("Error upserting user:", error);
    } else {
        console.log("User upserted successfully");
    }
}

// Initialize the table
createExcelTable(data);
window.updateUser = updateUser;